(()=>{"use strict";var t={144:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TinyMCEField=void 0;const i=n(311),s=(t,e={})=>{let n;return()=>{void 0===n?n=Craft.createElementSelectorModal(t,Object.assign({resizable:!0,multiSelect:!1,disableOnSelect:!0},e)):n.show()}};e.TinyMCEField=class{constructor(t,e={}){this._settings=t,console.log(this._settings);const n=this._init.bind(this),i=this._setup.bind(this),s=Object.assign({skin:"craft",plugins:"autoresize lists link image code",content_css:!1,menubar:!1,statusbar:!1,toolbar:"undo redo | blocks | bold italic strikethrough | bullist numlist | insertLink insertMedia | hr | code",allow_conditional_comments:!1,element_format:"html",fix_list_elements:!0,relative_urls:!1,remove_script_host:!1,anchor_top:!1,anchor_bottom:!1,autoresize_bottom_margin:0},e,{selector:`#${this._settings.id}`,language:this._settings.language,directionality:this._settings.direction,setup:i,init_instance_callback(t){n(t);const i=e.init_instance_callback;"function"==typeof i&&i.apply(this,arguments)}});tinymce.init(s).then((()=>{}),(()=>{}))}_commandHandleFromElementType(t){var e;return null===(e=t.split("\\").pop())||void 0===e?void 0:e.toLowerCase()}_setup(t){const e=[{type:"menuitem",text:Craft.t("tinymce","Insert/edit link"),onAction:()=>t.execCommand("mceLink")}],n=[{type:"menuitem",text:Craft.t("tinymce","Insert/edit image"),onAction:()=>t.execCommand("mceImage")}];for(const{elementType:n,optionTitle:i,sources:o}of this._settings.linkOptions){const a=this._commandHandleFromElementType(n),r=s(n,{sources:o,criteria:{locale:this._settings.locale},onSelect:([e])=>{const n=t.selection.getContent();var s,o,r,l,c;t.windowManager.open((s=i,o=[{type:"input",name:"url",label:Craft.t("tinymce","URL"),enabled:!1},{type:"input",name:"text",label:Craft.t("tinymce","Text")},{type:"checkbox",name:"newTab",label:Craft.t("tinymce","Open in new tab?")},{type:"selectbox",name:"site",label:Craft.t("tinymce","Site"),items:this._settings.allSites}],r={url:`${e.url}#${a}:${e.id}@${this._settings.elementSiteId}`,text:null!=n?n:e.label,site:this._settings.elementSiteId},l=t=>{const e=t.getData();t.setData({url:e.url.replace(/@[0-9]+$/,`@${e.site}`)})},c=e=>{const i=e.getData(),s=n.length>0?"mceReplaceContent":"mceInsertContent",o=`<a href="${i.url}" title="${i.text}"${i.newTab?' target="_blank"':""}>${i.text}</a>`;t.execCommand(s,!1,o),e.close()},{title:Craft.t("tinymce",s),body:{type:"panel",items:o},buttons:[{type:"cancel",name:"cancel",text:Craft.t("tinymce","Cancel")},{type:"submit",name:"submit",text:Craft.t("tinymce","Save"),buttonType:"primary"}],initialData:r,onChange:l,onSubmit:c}))}});e.push({type:"menuitem",text:i,onAction:()=>r()})}t.ui.registry.addMenuButton("insertLink",{icon:"link",tooltip:Craft.t("tinymce","Link"),fetch:t=>t(e)});for(const{elementType:e,optionTitle:i,sources:o}of this._settings.mediaOptions){const a=this._commandHandleFromElementType(e),r=s(e,{sources:o,transforms:this._settings.transforms,storageKey:"RichTextFieldType.ChooseImage",criteria:{locale:this._settings.locale,kind:"image"},onSelect:([e],n=null)=>{const i=t.selection.getContent(),s=`${e.url}#${a}:${e.id}`+(null!==n?`:${n}`:""),o=e.label,r=i.length>0?"mceReplaceContent":"mceInsertContent";t.execCommand(r,!1,`<img src="${s}" alt="${o}" width="" height="">`)}});n.push({type:"menuitem",text:i,onAction:()=>r()})}t.ui.registry.addMenuButton("insertMedia",{icon:"image",tooltip:Craft.t("tinymce","Image"),fetch:t=>t(n)})}_init(t){const e=i(t.container),n=i(t.formElement);t.on("focus",(t=>e.addClass("mce-focused"))),t.on("blur",(t=>e.removeClass("mce-focused")));const s=n.data("elementEditor");new window.MutationObserver((()=>{i(t.targetElm).val(t.getContent());(s.isFullPage?Garnish.$bod:n).trigger("change")})).observe(t.getBody(),{characterData:!0,childList:!0,subtree:!0}),t.addShortcut("meta+s","",(()=>Garnish.uiLayerManager.triggerShortcut(new KeyboardEvent("keydown",{shiftKey:!1,metaKey:!0,ctrlKey:!0,altKey:!1,keyCode:Garnish.S_KEY})))),t.addShortcut("shift+meta+s","",(()=>Garnish.uiLayerManager.triggerShortcut(new KeyboardEvent("keydown",{shiftKey:!0,metaKey:!0,ctrlKey:!0,altKey:!1,keyCode:Garnish.S_KEY}))))}}},311:t=>{t.exports=jQuery}},e={};function n(i){var s=e[i];if(void 0!==s)return s.exports;var o=e[i]={exports:{}};return t[i](o,o.exports,n),o.exports}(()=>{const t=n(144);window.initTinyMCE=e=>new t.TinyMCEField(e)})()})();
//# sourceMappingURL=input.js.map